<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
      <title>Profile Page</title>
    <script src="https://chyzhique.github.io/site/scripts/navbar.js" defer></script>
    <script src="https://chyzhique.github.io/site/scripts/passage.js" defer></script>
  <link rel="stylesheet" type="text/css" href="https://chyzhique.github.io/site/styles/styles.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <link rel="icon" type="image/x-icon" href="https://www.dropbox.com/scl/fi/a0qiv80qrjzu8vvvv2ouk/512sign.png?rlkey=ykjui910b9eufvs1n0yzbok2s&st=m0y64ssi&raw=1">
    <link rel="stylesheet" type="text/css" href="https://chyzhique.github.io/site/styles/navbar.css">
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js";

// Your Firebase configuration
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_AUTH_DOMAIN",
  projectId: "YOUR_PROJECT_ID",
  storageBucket: "YOUR_STORAGE_BUCKET",
  messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
  appId: "YOUR_APP_ID"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// Fetch and display user information
onAuthStateChanged(auth, async (user) => {
  if (user) {
    const userNameElement = document.getElementById('user-name');
    const userEmailElement = document.getElementById('user-email');

    // Fetch user data from Firestore
    const userDoc = await getDoc(doc(db, 'users', user.uid));
    if (userDoc.exists()) {
      const userData = userDoc.data();
      userNameElement.textContent = userData.name || user.displayName;
      userEmailElement.textContent = userData.email || user.email;
    } else {
      // No user document, use auth user data
      userNameElement.textContent = user.displayName;
      userEmailElement.textContent = user.email;
    }
  } else {
    // No user is signed in, redirect to login page
    window.location.href = 'login.html';
  }
});

// Logout functionality
document.getElementById('logout-button').addEventListener('click', () => {
  signOut(auth).then(() => {
    window.location.href = 'login.html';
  }).catch((error) => {
    console.error('Error signing out: ', error);
  });
});
</script>
</head>
<body>
<body>
    <div class="profile-container">
        <h1>Welcome, <span id="user-name"></span></h1>
        <p>Email: <span id="user-email"></span></p>
        <button id="logout-button">Logout</button>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js"></script>
    <script src="profile.js"></script>
</body>
</html>

  <script>
    function displayProfile(profile) {
      if (profile) {
        document.getElementById('profileInfo').innerHTML = `
          <p>Email: ${profile.email}</p>
          <!-- Add more profile information as needed -->
        `;
      } else {
        document.getElementById('profileInfo').innerHTML = '<p>Error fetching profile information.</p>';
      }
    }

    google.script.run.withSuccessHandler(displayProfile).getUserProfile();
  </script>
</body>
</html>
